<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title>Media Album: Themes HOWTO</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" href="global.css"/>
	<link rel="stylesheet" type="text/css" href="dev.css"/>
</head>
<body>
	<h1>Media Album: Theme HOWTO</h1>
	<div>
	This guide is to help Media Album users develop <em>themes</em> to customize
	the look and feel of Media Album shared albums and the browsing experience. 
	</div>

	<div class="note-float-r" style="width: 30%">
	For more information on XSLT, check out 
	<a href="http://www.w3.org/TR/xslt">http://www.w3.org/TR/xslt</a>.
	</div>

	<div>
	Media Album uses XML and XSLT to render pages into HTML. This approach makes
	it possible to also render into other XML formats, such as WML for cell
	phones or XML for web services, but this guide will focus on rendering to
	HTML.
	Writing a theme from scratch can be quite overwhelming if you are unfamiliar
	with XSLT, but you can always start with an existing theme and make tweaks
	to see how everything works.
	</div>

	<ol>
		<li><a href="#album-xml">Album slideshow XML</a></li>
		<li><a href="#browse-xml">Browse XML</a></li>
		<li><a href="#schema">Media Album schema</a></li>
		<li>
			<a href="#xsl">Theme XSL</a>
			<ol>
				<li><a href="#xsl-params">XSL parameters</a></li>	
				<li><a href="#xsl-variables">XSL predefined variables</a></li>	
			</ol>	
		</li>
		<li><a href="#media-server">Media Server</a></li>
		<li><a href="#xsl-templates">XSL predefined templates</a></li>
	</ol>

	<a name="album-xml"></a>
	<h2>Album XML</h2>

	<div>
	The XML for an album slideshow is used to display the <em>slideshow</em>
	mode for viewing an album. The slideshow mode is used when you visit a
	shared album's URL or by clicking the <strong>Slideshow</strong> link for an
	album while browsing a media collection. The XML looks similar to the
	following (note the XML namespaces are not shown):
	</div>
	
	<div class="example"><span class="synComment">&lt;?</span><span class="synType">xml version</span>=<span class="synConstant">&quot;1.0&quot;</span><span class="synType"> encoding</span>=<span class="synConstant">&quot;UTF-8&quot;</span><span class="synComment">?&gt;</span>
<span class="synIdentifier">&lt;media-album-data </span><span class="synType">admin</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier"> </span><span class="synType">displayAlbum</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier">&gt;</span>
    <span class="synIdentifier">&lt;user </span><span class="synType">anonymousKey</span>=<span class="synConstant">&quot;0/8MudyVj7OphxpoiXyfvnWoalk&quot;</span>
        <span class="synType">singleCompress</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">singleSize</span>=<span class="synConstant">&quot;normal&quot;</span>
        <span class="synType">thumbCompress</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">thumbSize</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">userId</span>=<span class="synConstant">&quot;7&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;username&gt;</span>test<span class="synIdentifier">&lt;/username&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>Test User<span class="synIdentifier">&lt;/name&gt;</span>
        <span class="synIdentifier">&lt;email&gt;</span>test@msqr.us<span class="synIdentifier">&lt;/email&gt;</span>
        <span class="synIdentifier">&lt;password&gt;</span>{SHA}qUqP5cyxm6YcTAhz05Hph5gvu9M=<span class="synIdentifier">&lt;/password&gt;</span>
        <span class="synIdentifier">&lt;permissions </span><span class="synType">assignCreateUser</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier"> </span><span class="synType">assignSuperUser</span>=<span class="synConstant">&quot;false&quot;</span>
            <span class="synType">createUser</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier"> </span><span class="synType">permId</span>=<span class="synConstant">&quot;7&quot;</span><span class="synIdentifier"> </span><span class="synType">superUser</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier">/&gt;</span>
    <span class="synIdentifier">&lt;/user&gt;</span>
    <span class="synIdentifier">&lt;settings </span><span class="synType">mediaServer</span>=<span class="synConstant">&quot;internal&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;thumbnail </span><span class="synType">compress</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">height</span>=<span class="synConstant">&quot;90&quot;</span><span class="synIdentifier"> </span><span class="synType">size</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">width</span>=<span class="synConstant">&quot;120&quot;</span><span class="synIdentifier">/&gt;</span>
        <span class="synIdentifier">&lt;single </span><span class="synType">compress</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">height</span>=<span class="synConstant">&quot;480&quot;</span><span class="synIdentifier"> </span><span class="synType">size</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">width</span>=<span class="synConstant">&quot;640&quot;</span><span class="synIdentifier">/&gt;</span>
    <span class="synIdentifier">&lt;/settings&gt;</span>
    <span class="synIdentifier">&lt;theme </span><span class="synType">author</span>=<span class="synConstant">&quot;Test User&quot;</span><span class="synIdentifier"> </span><span class="synType">authorEmail</span>=<span class="synConstant">&quot;test@msqr.us&quot;</span>
        <span class="synType">creationDate</span>=<span class="synConstant">&quot;2004-03-13T09:28:03.605&quot;</span><span class="synIdentifier"> </span><span class="synType">global</span>=<span class="synConstant">&quot;true&quot;</span><span class="synIdentifier"> </span><span class="synType">owner</span>=<span class="synConstant">&quot;7&quot;</span><span class="synIdentifier"> </span><span class="synType">themeId</span>=<span class="synConstant">&quot;2&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>Kewl Theme<span class="synIdentifier">&lt;/name&gt;</span>
        <span class="synIdentifier">&lt;comment&gt;</span>This is my kewl theme, dude.<span class="synIdentifier">&lt;/comment&gt;</span>
        <span class="synIdentifier">&lt;base-dir&gt;</span>user/7/1079198883605/<span class="synIdentifier">&lt;/base-dir&gt;</span>
        <span class="synIdentifier">&lt;icon&gt;</span>thumbnail.png<span class="synIdentifier">&lt;/icon&gt;</span>
        <span class="synIdentifier">&lt;preview&gt;</span>preview.png<span class="synIdentifier">&lt;/preview&gt;</span>
        <span class="synIdentifier">&lt;xsl&gt;</span>album.xsl<span class="synIdentifier">&lt;/xsl&gt;</span>
        <span class="synIdentifier">&lt;css&gt;</span>album.css<span class="synIdentifier">&lt;/css&gt;</span>
    <span class="synIdentifier">&lt;/theme&gt;</span>
    <span class="synIdentifier">&lt;collection </span><span class="synType">collectionId</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier"> </span><span class="synType">owner</span>=<span class="synConstant">&quot;7&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;path&gt;</span>test/1079127525550/<span class="synIdentifier">&lt;/path&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>Default<span class="synIdentifier">&lt;/name&gt;</span>
        <span class="synIdentifier">&lt;scandate&gt;</span>2004-03-12T14:15:39.581<span class="synIdentifier">&lt;/scandate&gt;</span>
    <span class="synIdentifier">&lt;/collection&gt;</span>
    <span class="synIdentifier">&lt;album </span><span class="synType">albumDate</span>=<span class="synConstant">&quot;2004-03-12T00:00:00.000&quot;</span><span class="synIdentifier"> </span><span class="synType">albumId</span>=<span class="synConstant">&quot;1&quot;</span>
<span class="synIdentifier">        </span><span class="synType">allowAnonymous</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier"> </span><span class="synType">allowOriginal</span>=<span class="synConstant">&quot;false&quot;</span>
<span class="synIdentifier">        </span><span class="synType">anonymousKey</span>=<span class="synConstant">&quot;Plua194dSHckPeCzpMNTU454mGgY0&quot;</span>
<span class="synIdentifier">        </span><span class="synType">creationDate</span>=<span class="synConstant">&quot;2004-03-12T14:15:50.812&quot;</span>
<span class="synIdentifier">        </span><span class="synType">modificationDate</span>=<span class="synConstant">&quot;2004-03-13T16:40:25.970&quot;</span><span class="synIdentifier"> </span><span class="synType">owner</span>=<span class="synConstant">&quot;7&quot;</span>
<span class="synIdentifier">        </span><span class="synType">posterId</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier"> </span><span class="synType">sortMode</span>=<span class="synConstant">&quot;0&quot;</span><span class="synIdentifier"> </span><span class="synType">themeId</span>=<span class="synConstant">&quot;2&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>My Album<span class="synIdentifier">&lt;/name&gt;</span>
        <span class="synIdentifier">&lt;comment&gt;</span>This is an album, dude.<span class="synIdentifier">&lt;/comment&gt;</span>
        <span class="synIdentifier">&lt;item </span><span class="synType">creationDate</span>=<span class="synConstant">&quot;2002-12-11T21:18:54.000&quot;</span><span class="synIdentifier"> </span><span class="synType">displayOrder</span>=<span class="synConstant">&quot;1&quot;</span>
<span class="synIdentifier">            </span><span class="synType">fileSize</span>=<span class="synConstant">&quot;740951&quot;</span><span class="synIdentifier"> </span><span class="synType">collection</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier"> </span><span class="synType">height</span>=<span class="synConstant">&quot;1600&quot;</span><span class="synIdentifier"> </span><span class="synType">hits</span>=<span class="synConstant">&quot;1&quot;</span>
<span class="synIdentifier">            </span><span class="synType">itemId</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier"> </span><span class="synType">tzName</span>=<span class="synConstant">&quot;GMT-08:00&quot;</span><span class="synIdentifier"> </span><span class="synType">width</span>=<span class="synConstant">&quot;1200&quot;</span><span class="synIdentifier">&gt;</span>
            <span class="synIdentifier">&lt;path&gt;</span>IMG_0900.jpg<span class="synIdentifier">&lt;/path&gt;</span>
            <span class="synIdentifier">&lt;mime&gt;</span>image/jpeg<span class="synIdentifier">&lt;/mime&gt;</span>
            <span class="synIdentifier">&lt;name&gt;</span>Yee haw<span class="synIdentifier">&lt;/name&gt;</span>
            <span class="synIdentifier">&lt;meta&gt;</span>|aCanon|bCanon PowerShot S330|c6|d6|e2|f89<span class="synIdentifier">&lt;/meta&gt;</span>
        <span class="synIdentifier">&lt;/item&gt;</span>
        <span class="synIdentifier">&lt;item </span><span class="synType">creationDate</span>=<span class="synConstant">&quot;2004-03-12T14:15:39.000&quot;</span><span class="synIdentifier"> </span><span class="synType">displayOrder</span>=<span class="synConstant">&quot;2&quot;</span>
<span class="synIdentifier">            </span><span class="synType">fileSize</span>=<span class="synConstant">&quot;86238&quot;</span><span class="synIdentifier"> </span><span class="synType">collection</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier"> </span><span class="synType">height</span>=<span class="synConstant">&quot;513&quot;</span><span class="synIdentifier"> </span><span class="synType">hits</span>=<span class="synConstant">&quot;1&quot;</span>
<span class="synIdentifier">            </span><span class="synType">itemId</span>=<span class="synConstant">&quot;2&quot;</span><span class="synIdentifier"> </span><span class="synType">tzName</span>=<span class="synConstant">&quot;GMT-08:00&quot;</span><span class="synIdentifier"> </span><span class="synType">width</span>=<span class="synConstant">&quot;720&quot;</span><span class="synIdentifier">&gt;</span>
            <span class="synIdentifier">&lt;path&gt;</span>ShowLetter.jpg<span class="synIdentifier">&lt;/path&gt;</span>
            <span class="synIdentifier">&lt;mime&gt;</span>image/jpeg<span class="synIdentifier">&lt;/mime&gt;</span>
            <span class="synIdentifier">&lt;name&gt;</span>Woa<span class="synIdentifier">&lt;/name&gt;</span>
        <span class="synIdentifier">&lt;/item&gt;</span>
    <span class="synIdentifier">&lt;/album&gt;</span>
<span class="synIdentifier">&lt;/media-album-data&gt;</span></div>

	<div class="example-cap">
	Example album source XML.
	</div>

	<a name="browse-xml"></a>
	<h2>Browse XML</h2>

	<div>
	The browse XML is used to display the <em>browse</em>
	mode for viewing a media collection. The XML looks similar to the
	following (note the XML namespaces are not shown):
	</div>
	
	<div class="example"><span class="synComment">&lt;?</span><span class="synType">xml version</span>=<span class="synConstant">&quot;1.0&quot;</span><span class="synType"> encoding</span>=<span class="synConstant">&quot;UTF-8&quot;</span><span class="synComment">?&gt;</span>
<span class="synIdentifier">&lt;browse-data </span><span class="synType">admin</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier"> </span><span class="synType">browseName</span>=<span class="synConstant">&quot;Browse By Date&quot;</span><span class="synIdentifier"> </span><span class="synType">displayItem</span>=<span class="synConstant">&quot;1&quot;</span>
<span class="synIdentifier">    </span><span class="synType">displayPage</span>=<span class="synConstant">&quot;0&quot;</span><span class="synIdentifier"> </span><span class="synType">key</span>=<span class="synConstant">&quot;0/8MudyVj7OphxpoiXyfvnWoalk&quot;</span><span class="synIdentifier"> </span><span class="synType">pageSize</span>=<span class="synConstant">&quot;5&quot;</span>
<span class="synIdentifier">    </span><span class="synType">totalAlbums</span>=<span class="synConstant">&quot;4&quot;</span><span class="synIdentifier"> </span><span class="synType">totalItems</span>=<span class="synConstant">&quot;2&quot;</span><span class="synIdentifier"> </span><span class="synType">totalPages</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier">&gt;</span>
    <span class="synIdentifier">&lt;user </span><span class="synType">anonymousKey</span>=<span class="synConstant">&quot;0/8MudyVj7OphxpoiXyfvnWoalk&quot;</span>
<span class="synIdentifier">        </span><span
class="synType">singleCompress</span>=<span
class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">singleSize</span>=<span
class="synConstant">&quot;normal&quot;</span>
<span class="synIdentifier">        </span><span class="synType">thumbCompress</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">thumbSize</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">userId</span>=<span class="synConstant">&quot;7&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;username&gt;</span>test<span class="synIdentifier">&lt;/username&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>Test User<span class="synIdentifier">&lt;/name&gt;</span>
        <span class="synIdentifier">&lt;email&gt;</span>test@msqr.us<span class="synIdentifier">&lt;/email&gt;</span>
        <span class="synIdentifier">&lt;password&gt;</span>{SHA}qUqP5cyxm6YcTAhz05Hph5gvu9M=<span class="synIdentifier">&lt;/password&gt;</span>
        <span class="synIdentifier">&lt;permissions </span><span class="synType">assignCreateUser</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier"> </span><span class="synType">assignSuperUser</span>=<span class="synConstant">&quot;false&quot;</span>
            <span class="synType">createUser</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier"> </span><span class="synType">permId</span>=<span class="synConstant">&quot;7&quot;</span><span class="synIdentifier"> </span><span class="synType">superUser</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier">/&gt;</span>
    <span class="synIdentifier">&lt;/user&gt;</span>
    <span class="synIdentifier">&lt;settings </span><span class="synType">mediaServer</span>=<span class="synConstant">&quot;internal&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;thumbnail </span><span class="synType">compress</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">height</span>=<span class="synConstant">&quot;90&quot;</span><span class="synIdentifier"> </span><span class="synType">size</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">width</span>=<span class="synConstant">&quot;120&quot;</span><span class="synIdentifier">/&gt;</span>
        <span class="synIdentifier">&lt;single </span><span class="synType">compress</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">height</span>=<span class="synConstant">&quot;480&quot;</span><span class="synIdentifier"> </span><span class="synType">size</span>=<span class="synConstant">&quot;normal&quot;</span><span class="synIdentifier"> </span><span class="synType">width</span>=<span class="synConstant">&quot;640&quot;</span><span class="synIdentifier">/&gt;</span>
    <span class="synIdentifier">&lt;/settings&gt;</span>
    <span class="synIdentifier">&lt;theme </span><span class="synType">author</span>=<span class="synConstant">&quot;Matt Magoffin&quot;</span><span class="synIdentifier"> </span><span class="synType">authorEmail</span>=<span class="synConstant">&quot;spamsqr@msqr.us&quot;</span>
        <span class="synType">creationDate</span>=<span class="synConstant">&quot;2004-03-12T12:57:16.161&quot;</span><span class="synIdentifier"> </span><span class="synType">global</span>=<span class="synConstant">&quot;true&quot;</span><span class="synIdentifier"> </span><span class="synType">owner</span>=<span class="synConstant">&quot;0&quot;</span><span class="synIdentifier"> </span><span class="synType">themeId</span>=<span class="synConstant">&quot;-1&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>Default Theme<span class="synIdentifier">&lt;/name&gt;</span>
        <span class="synIdentifier">&lt;comment&gt;</span>This is the default theme.<span class="synIdentifier">&lt;/comment&gt;</span>
        <span class="synIdentifier">&lt;base-dir&gt;</span>inc/standard/default/<span class="synIdentifier">&lt;/base-dir&gt;</span>
        <span class="synIdentifier">&lt;icon&gt;</span>thumbnail.png<span class="synIdentifier">&lt;/icon&gt;</span>
        <span class="synIdentifier">&lt;preview&gt;</span>preview.png<span class="synIdentifier">&lt;/preview&gt;</span>
        <span class="synIdentifier">&lt;xsl&gt;</span>album.xsl<span class="synIdentifier">&lt;/xsl&gt;</span>
        <span class="synIdentifier">&lt;css&gt;</span>album.css<span class="synIdentifier">&lt;/css&gt;</span>
    <span class="synIdentifier">&lt;/theme&gt;</span>
    <span class="synIdentifier">&lt;album-crumb </span><span class="synType">album</span>=<span class="synConstant">&quot;2002&quot;</span><span class="synIdentifier"> </span><span class="synType">page</span>=<span class="synConstant">&quot;0&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>2002<span class="synIdentifier">&lt;/name&gt;</span>
    <span class="synIdentifier">&lt;/album-crumb&gt;</span>
    <span class="synIdentifier">&lt;album-crumb </span><span class="synType">album</span>=<span class="synConstant">&quot;200211&quot;</span><span class="synIdentifier"> </span><span class="synType">page</span>=<span class="synConstant">&quot;0&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>December<span class="synIdentifier">&lt;/name&gt;</span>
    <span class="synIdentifier">&lt;/album-crumb&gt;</span>
    <span class="synIdentifier">&lt;album </span><span class="synType">albumId</span>=<span class="synConstant">&quot;200211&quot;</span><span class="synIdentifier"> </span><span class="synType">allowAnonymous</span>=<span class="synConstant">&quot;false&quot;</span><span class="synIdentifier"> </span><span class="synType">allowOriginal</span>=<span class="synConstant">&quot;false&quot;</span>
<span class="synIdentifier">        </span><span class="synType">owner</span>=<span class="synConstant">&quot;7&quot;</span><span class="synIdentifier"> </span><span class="synType">parentId</span>=<span class="synConstant">&quot;2002&quot;</span><span class="synIdentifier"> </span><span class="synType">posterId</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier"> </span><span class="synType">sortMode</span>=<span class="synConstant">&quot;0&quot;</span><span class="synIdentifier">&gt;</span>
        <span class="synIdentifier">&lt;name&gt;</span>December<span class="synIdentifier">&lt;/name&gt;</span>
        <span class="synIdentifier">&lt;item </span><span class="synType">creationDate</span>=<span class="synConstant">&quot;2002-12-11T21:18:54.000&quot;</span><span class="synIdentifier"> </span><span class="synType">fileSize</span>=<span class="synConstant">&quot;740951&quot;</span>
<span class="synIdentifier">            </span><span class="synType">collection</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier"> </span><span class="synType">height</span>=<span class="synConstant">&quot;1600&quot;</span><span class="synIdentifier"> </span><span class="synType">hits</span>=<span class="synConstant">&quot;1&quot;</span><span class="synIdentifier"> </span><span class="synType">itemId</span>=<span class="synConstant">&quot;1&quot;</span>
<span class="synIdentifier">            </span><span class="synType">tzName</span>=<span class="synConstant">&quot;GMT-08:00&quot;</span><span class="synIdentifier"> </span><span class="synType">width</span>=<span class="synConstant">&quot;1200&quot;</span><span class="synIdentifier">&gt;</span>
            <span class="synIdentifier">&lt;path&gt;</span>IMG_0900.jpg<span class="synIdentifier">&lt;/path&gt;</span>
            <span class="synIdentifier">&lt;mime&gt;</span>image/jpeg<span class="synIdentifier">&lt;/mime&gt;</span>
            <span class="synIdentifier">&lt;name&gt;</span>Yee haw<span class="synIdentifier">&lt;/name&gt;</span>
            <span class="synIdentifier">&lt;meta&gt;</span>|aCanon|bCanon PowerShot S330|c6|d6|e2|f89<span class="synIdentifier">&lt;/meta&gt;</span>
        <span class="synIdentifier">&lt;/item&gt;</span>
    <span class="synIdentifier">&lt;/album&gt;</span>
<span class="synIdentifier">&lt;/browse-data&gt;</span></div>
	
	<div class="example-cap">
	Example browse source XML
	</div>

	<a name="schema"></a>
	<h2>Media Album schema</h2>

	<div>
		The XML used by Media Album is defined by a set of XML Schema
		definitions. Check out the <a href="schema-ref/index.html">Media Album
		XML Schema Reference</a> for detailed information about the XML objects
		used by the applicaiton. You can also <a href="schema/">browse the schema files</a> (both
		the <code>.xsd</code> source and <code>.html</code> syntax-colored
		versions) to look at all the objects defined.
	</div>


	<a name="xsl"></a>
	<h2>Theme XSL</h2>

	<div>
	The album XSL's job is generally to take album and browse XML objects and
	transform them into some representation of HTML so a person viewing
	the album or browsing the media collection can see the contents of it.
	</div>


	<a name="xsl-theme-shell"></a>
	<h3>Header and footer theme XSL</h3>

	<div class="h3">
		<div>For themes, some XSL is prepended and appended automatically by the
		Media Album application. This takes care of setting up the XSL stylesheet
		so that your theme only needs to define the XSL templates necessary to
		render the HTML.
		</div>
	
	<div class="example"><span class="synComment">&lt;?</span><span class="synType">xml version</span>=<span class="synConstant">&quot;1.0&quot;</span><span class="synType"> encoding</span>=<span class="synConstant">&quot;utf-8&quot;</span>
<span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">stylesheet</span><span class="synIdentifier"> </span><span class="synType">xmlns</span><span class="synComment">:</span><span class="synType">xsl</span>=<span class="synConstant">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><span class="synIdentifier"> </span><span class="synType">version</span>=<span class="synConstant">&quot;1.0&quot;</span>
<span class="synIdentifier">  </span><span class="synType">xmlns</span><span class="synComment">:</span><span class="synType">ma</span><span class="synIdentifier"> </span>=<span class="synIdentifier"> </span><span class="synConstant">&quot;http://msqr.us/xsd/MediaAlbum&quot;</span>
<span class="synIdentifier">  </span><span class="synType">xmlns</span><span class="synComment">:</span><span class="synType">date</span>=<span class="synConstant">&quot;http://exslt.org/dates-and-times&quot;</span><span class="synIdentifier">&gt;</span>

  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">import</span><span class="synIdentifier"> </span><span class="synType">href</span>=<span class="synConstant">&quot;../../../theme-util-to-html.xsl&quot;</span><span class="synIdentifier">/&gt;</span>

  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">import</span><span class="synIdentifier"> </span><span class="synType">href</span>=<span class="synConstant">&quot;../../../../exslt/date.format-date.template.xsl&quot;</span><span class="synIdentifier">/&gt;</span>

  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">output</span><span class="synIdentifier"> </span><span class="synType">method</span>=<span class="synConstant">&quot;html&quot;</span><span class="synIdentifier"> </span><span class="synType">indent</span>=<span class="synConstant">&quot;yes&quot;</span><span class="synIdentifier"> </span>
<span class="synIdentifier">    </span><span class="synType">doctype-public</span>=<span class="synConstant">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span><span class="synIdentifier">/&gt;</span>
  
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">param</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;user-agent&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">param</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;web-context&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">param</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;url-path&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span
  class="synSpecial">xsl</span><span class="synComment">:</span><span
  class="synStatement">param</span><span class="synIdentifier"> </span><span
  class="synType">name</span>=<span
  class="synConstant">&quot;album-mode&quot;</span><span
  class="synIdentifier">/&gt;</span>

  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;thumbCompress&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;/*/ma:settings/ma:thumbnail/@compress&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;singleCompress&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;/*/ma:settings/ma:single/@compress&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;thumbSize&quot;</span><span class="synIdentifier">&gt;</span>t<span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">value-of</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;/*/ma:settings/ma:thumbnail/@size&quot;</span><span class="synIdentifier">/&gt;&lt;/</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier">&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;singleSize&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;/*/ma:settings/ma:single/@size&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;thumbMaxWidth&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;number(/*/ma:settings/ma:thumbnail/@width)&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;thumbMaxHeight&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;number(/*/ma:settings/ma:thumbnail/@height)&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;thumbMaxRatio&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;$thumbMaxHeight div $thumbMaxWidth&quot;</span><span class="synIdentifier">/&gt;</span>

  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;rootAlbum&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;/*/ma:album[1]&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;displayAlbumId&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;/*/@displayAlbum&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;displayAlbum&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;//ma:album[@albumId = $displayAlbumId]&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;item&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;//ma:item[1]&quot;</span><span class="synIdentifier">/&gt;</span>
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;user&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;/*/ma:user[1]&quot;</span><span class="synIdentifier">/&gt;</span>
  
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;ua-type&quot;</span><span class="synIdentifier">&gt;</span>
    <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">call-template</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;get-browser-type&quot;</span><span class="synIdentifier">&gt;</span>
      <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">with-param</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;ua&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;$user-agent&quot;</span><span class="synIdentifier">/&gt;</span>
    <span class="synIdentifier">&lt;/</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">call-template</span><span class="synIdentifier">&gt;</span>
  <span class="synIdentifier">&lt;/</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier">&gt;</span>

  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;ua-platform&quot;</span><span class="synIdentifier">&gt;</span>
    <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">call-template</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;get-browser-platform&quot;</span><span class="synIdentifier">&gt;</span>
      <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">with-param</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;ua&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;$user-agent&quot;</span><span class="synIdentifier">/&gt;</span>
    <span class="synIdentifier">&lt;/</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">call-template</span><span class="synIdentifier">&gt;</span>
  <span class="synIdentifier">&lt;/</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier">&gt;</span>
  
  <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;ua-version&quot;</span><span class="synIdentifier">&gt;</span>
    <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">call-template</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;get-browser-version&quot;</span><span class="synIdentifier">&gt;</span>
      <span class="synIdentifier">&lt;</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">with-param</span><span class="synIdentifier"> </span><span class="synType">name</span>=<span class="synConstant">&quot;ua&quot;</span><span class="synIdentifier"> </span><span class="synType">select</span>=<span class="synConstant">&quot;$user-agent&quot;</span><span class="synIdentifier">/&gt;</span>
    <span class="synIdentifier">&lt;/</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">call-template</span><span class="synIdentifier">&gt;</span>
  <span class="synIdentifier">&lt;/</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">variable</span><span class="synIdentifier">&gt;</span></div>
	
	<div class="example-cap">
	Theme XSL header, prepended to theme XSL
	</div>
	
	<div>
	The custom album theme XSL will be inserted after this, and then the XSL will be 
	automatically closed with the following XSL snippet:
	</div>
	
	<div class="example"><span class="synIdentifier">&lt;/</span><span class="synSpecial">xsl</span><span class="synComment">:</span><span class="synStatement">stylesheet</span><span class="synIdentifier">&gt;</span></div>
	
	<div class="example-cap">
	Theme XSL footer, appended to theme XSL
	</div>

	</div><!-- h3 -->
	
	<a name="xsl-params"></a>
	<h3>XSL parameters</h3>

	<div class="h3">
		<div>
			The header XSL defines several XSL parameters. They are as follows:
		</div>

		<div>
			<table>
				<tbody>
					<tr>
						<th>XSL <code>param</code></th>
						<th>Description</th>
					</tr>
					<tr>
						<td><code>album-mode</code></td>
						<td>
							 <div>
							 A constant representing an alternate view mode. If
							 unspecified then the normal album slideshow mode is
							 desired, otherwise this is
							 used to show alternate modes like item metadata (in a 
							 slideshow). Supported values are:
							 </div>
							 <dl class="code">
							 	<dt>browse</dt>
								<dd>For browse mode (not really necessary since the
								root XML object is different for browsing than for
								slideshow).</dd>

								<dt>item-meta</dt>
								<dd>For displaying the metadata for a single item.</dd>
							</dl>
						</td>
					</tr>
					<tr>
						<td><code>url-path</code></td>
						<td>
							The URL path used during browse mode for the current
							request. This is required to construct browse URLs
							within the same browse mode context (i.e. browse by date,
							browse by popularity, etc).
						</td>
					</tr>
					<tr>
						<td><code>user-agent</code></td>
						<td>
							 The complete HTTP user-agent header value. This (along with 
							 the ua-type, ua-platform, and ua-version  shortcut
							 variables listed below) is useful for rendering different HTML 
							 based on the browser platform of the user.
						</td>
					</tr>
					<tr>
						<td><code>web-context</code></td>
						<td>
							The configured root web context used by Media Album. This
							is necessary to construct links to Media Album URLs.
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		
	</div><!-- h3 -->

	
	<a name="xsl-variables"></a>
	<h3>XSL variables</h3>

	<div class="h3">
	
	<div>
		The XSL also defines several XSL variables for convenience.
	</div>
	
	<div>
	<table>
		<tr>
			<th>XSL Variable</th><th>XSL Type</th><th>Description</th>
		</tr>
		<tr>
			<td><a name="thumbCompress"></a><code>thumbCompress</code></td>
			<td>String</td>
			<td>
				<div>
					The compression setting to use for thumbnail images. The compression setting
					is passed to the Media Server to vary the compression of the thumbnails,
					and could be one of the following:
				</div>
				<ol>
					<li><code>none</code></li>
					<li><code>normal</code></li>
					<li><code>medium</code></li>
					<li><code>high</code></li>
				</ol>
			</td>
		</tr>
		<tr>
			<td><a name="singleCompress"></a><code>singleCompress</code></td>
			<td>String</td>
			<td>
				The compression setting used for single images. Single images are the
				"full size" images, usually viewed one at a time, for example by clicking on a
				thumbnail image. See the compression values for <var>thumbCompress</var>.
			</td>
		</tr>
		<tr>
			<td><a name="thumbSize"></a><code>thumbSize</code></td>
			<td>String</td>
			<td>
				<div>
					The size setting use for thumbnail images. The size setting is passed to
					the Media Server to vary the size of the thumbnails, and could be one
					of the following:
				</div>
				<ol>
					<li><code>tsmall</code> (80x60)</li>
					<li><code>tnormal</code> (120x90)</li>
					<li><code>tbig</code> (160x120)</li>
				</ol>
			</td>
		</tr>
		<tr>
			<td><a name="singleSize"></a><code>singleSize</code></td>
			<td>String</td>
			<td>
				<div>
					The size setting use for single images. The size setting is passed to
					the Media Server to vary the size of the images, and could be one
					of the following:
				</div>
				<ol>
					<li><code>small</code> (320x240)</li>
					<li><code>normal</code> (640x480)</li>
					<li><code>medium</code> (800x600)</li>
					<li><code>big</code> (1024x768)</li>
					<li><code>huge</code> (1600x1200)</li>
				</ol>
			</td>
		</tr>
		<tr>
			<td><code>thumbMaxWidth</code></td>
			<td>Number</td>
			<td>
				The maximum width in pixels thumbnail images are allowed to be. Used to help
				calculate appropriate thumbnail image widths and heights.
			</td>
		</tr>
		<tr>
			<td><code>thumbMaxHeight</code></td>
			<td>Number</td>
			<td>
				The maximum height in pixels thumbnail images are allowed to be. Used to help
				calculate appropriate thumbnail image widths and heights.
			</td>
		</tr>
		<tr>
			<td><code>thumbMaxRatio</code></td>
			<td>Number</td>
			<td>
				The ratio of <var>thumbMaxHeight</var> to <var>thumbMaxWidth</var>. Used to help
				calculate appropriate thumbnail image widths and heights.
			</td>
		</tr>
		<tr>
			<td><code>rootAlbum</code></td>
			<td>Node</td>
			<td>
				The root album node. Since albums can be nested, this will always be the 
				top-most album. This node could be used to construct a list of nested
				albums (if available).
			</td>
		</tr>
		<tr>
			<td><code>displayAlbumId</code></td>
			<td>Number</td>
			<td>
				The ID if the album that should be shown. Since more than one album can
				be present in the XML, this is the ID of the album that should be shown
				to the user.
			</td>
		</tr>
		<tr>
			<td><code>displayAlbum</code></td>
			<td>Node</td>
			<td>
				The album node that should be shown. This is the album node that will 
				contain the &lt;item&gt; objects to display to the user.
			</td>
		</tr>
		<tr>
			<td><code>item</code></td>
			<td>Node</td>
			<td>
				The first item node, which usually means the item that should be
				displayed.
			</td>
		</tr>
		<tr>
			<td><code>user</code></td>
			<td>Node</td>
			<td>
				The current user node. The user node will only be present for
				logged in users.
			</td>
		</tr>
		<tr>
			<td><code>ua-type</code></td>
			<td>String</td>
			<td>
				<div>
					A coded shorthand for the current user agent. Currently this will be
					one of the following:
				</div>
				<ul>
					<li><code>ie</code> (Microsoft Internet Explorer)</li>
					<li><code>moz</code> (Any Gecko-based browser: Mozilla, Netscape 6+)</li>
					<li><code>unknown</code> (Anything else)</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td><code>ua-platform</code></td>
			<td>String</td>
			<td>
				<div>
					A coded shorthand for the current user agent's platform. Currently 
					this will be one of the following:
				</div>
				<ul>
					<li><code>win</code> (Microsoft Windows)</li>
					<li><code>mac</code> (Apple Macintosh)</li>
					<li><code>unknown</code> (Anything else)</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td><code>ua-version</code></td>
			<td>String</td>
			<td>
				A coded shorthand for the user agent's version. Currently this only
				works if the <var>ua-type</var> is <code>ie</code> or <code>moz</code>.
			</td>
		</tr>
	</table>
	</div>
	
	</div><!-- h3 -->

	<a name="media-server"></a>
	<h2>Media Server</h2>

	<div>
	The Media Server is the servlet that servers media items to client browsers.
	When you generate your HTML, you'll generate HTML &lt;img&gt; tags, for
	example, that have <code>src</code> attributes that point to Media Server
	URLs.
	</div>

	<div class="example"><span class="synIdentifier">&lt;</span><span class="synStatement">img</span><span class="synIdentifier"> </span><span class="synType">height</span><span class="synIdentifier">=</span><span class="synConstant">&quot;86&quot;</span><span class="synIdentifier"> </span><span class="synType">width</span><span class="synIdentifier">=</span><span class="synConstant">&quot;120&quot;</span><span class="synIdentifier"> </span>
<span class="synIdentifier">  </span><span class="synType">src</span><span class="synIdentifier">=</span><span class="synConstant">&quot;/ma/MediaServer?id=2&amp;s=normal&amp;c=normal&quot;</span><span class="synIdentifier"> </span>
<span class="synIdentifier">  </span><span class="synType">alt</span><span class="synIdentifier">=</span><span class="synConstant">&quot;Woa&quot;</span><span class="synIdentifier">&gt;</span></div>
		
	<div class="example-cap">
	Example HTML Media Server &lt;img&gt; tag
	</div>

	<div>
	You don't need to know how to generate these URLs, you smiply call the
	appropriate <a href="#xsl-templates">XSLT template</a> (e.g. 
	<a href="#xsl/index.html">render-image-tag</a> to render an &lt;img&gt;
	tag).
	</div>

	<a name="xsl-templates"></a>
	<h2>XSL predefined templates</h2>

	<div>
	Many templates are available for your theme which take care of rendering
	links to CSS or JavaScript objects, links to Media Server items (e.g.
	images), and many more. Visit the <a href="xsl/index.html">Media Album XSL 
	Template Reference</a> pages for more information.
	</div>

	<hr>
	<div><small>$Id: theme-howto.html,v 1.1 2007/01/08 04:39:03 matt Exp $</small></div>
</body>
</html>
