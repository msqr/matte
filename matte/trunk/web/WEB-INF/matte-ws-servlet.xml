<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC 
	"-//SPRING//DTD BEAN//EN" 
	"http://www.springframework.org/dtd/spring-beans.dtd">
<!--
	Copyright (c) 2007 Matt Magoffin
	
	This program is free software; you can redistribute it and/or 
	modify it under the terms of the GNU General Public License as 
	published by the Free Software Foundation; either version 2 of 
	the License, or (at your option) any later version.
	
	This program is distributed in the hope that it will be useful, 
	but WITHOUT ANY WARRANTY; without even the implied warranty of 
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU 
	General Public License for more details.
	
	You should have received a copy of the GNU General Public License 
	along with this program; if not, write to the Free Software 
	Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 
	02111-1307 USA
	
	$Id: web.xml,v 1.58 2007/08/27 04:04:21 matt Exp $
-->
<beans>
	
	<bean id="endpointMapping"
		class="org.springframework.ws.soap.server.endpoint.mapping.SoapActionEndpointMapping">
		<property name="mappings">
			<props>
				<prop key="http://msqr.us/matte/ws/AddMedia">addMediaEndpoint</prop>
			</props>
		</property>
		<property name="interceptors"> 
			<list>
				<ref bean="wsSecurityInterceptor"/>
			</list>
		</property>
	</bean>
	
	<bean id="endpointMethodMapping" 
		class="org.springframework.ws.soap.server.endpoint.mapping.SoapActionAnnotationMethodEndpointMapping">
		<property name="interceptors"> 
			<list>
				<ref bean="wsSecurityInterceptor"/>
			</list>
		</property>
	</bean>
	
	<bean class="org.springframework.ws.server.endpoint.adapter.MarshallingMethodEndpointAdapter">
		<constructor-arg ref="wsMarshaller"/>
	</bean>
	
	<bean id="messageFactory" class="org.springframework.ws.soap.axiom.AxiomSoapMessageFactory"> 
		<property name="payloadCaching" value="false"/> 
	</bean>
	
	<bean id="wsMarshaller" class="org.springframework.oxm.jaxb.Jaxb1Marshaller">
		<property name="contextPath" value="magoffin.matt.ma2.domain"/>
		<property name="validating" value="true"/>
		<property name="marshallerProperties">
			<map>
				<entry key="com.sun.xml.bind.namespacePrefixMapper" 
					value-ref="jaxbNamespacePrefixMapper"/>
			</map>
		</property>
	</bean>
	
	<bean id="wsSecurityInterceptor" 
		class="org.springframework.ws.soap.security.xwss.XwsSecurityInterceptor"> 
		<property name="policyConfiguration" value="classpath:wsSecurityPolicy.xml"/> 
		<property name="callbackHandlers">
			<list>
				<ref bean="authenticationHandler"/>
			</list>
		</property>
	</bean>
	
	<bean id="authenticationHandler" 
		class="magoffin.matt.ma2.web.service.PasswordValidationCallbackHandler">
		<property name="userBiz" ref="userBiz"/>	
	</bean>
	
	<bean id="matte" class="org.springframework.ws.wsdl.wsdl11.SimpleWsdl11Definition">
		<property name="wsdl" value="/WEB-INF/xsd/matte.wsdl"/>
	</bean>
	
	<bean id="addMediaEndpoint" class="magoffin.matt.ma2.web.service.AddMediaEndpoint">
		<property name="ioBiz" ref="ioBiz"/>
	</bean>
	
	<bean id="getCollectionListEndpoint" 
		class="magoffin.matt.ma2.web.service.GetCollectionListEndpoint">
		<property name="userBiz" ref="userBiz"/>
		<property name="domainObjectFactory" ref="domainObjectFactory"/>
		<property name="marshaller" ref="wsMarshaller"/>
		<property name="unmarshaller" ref="wsMarshaller"/>
	</bean>
	
</beans>